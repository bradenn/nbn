<!DOCTYPE html>
<html lang="en" <% if(user != null){ %>data-theme="<%= user.theme %>" <% }else{ %> data-theme="dark" <% } %>>
<%- include("partials/header.ejs"); %>

<body>
  <%- include("partials/nav.ejs"); %>
  <div class="container" style="margin-top:32px;">
    <div class="row">
      <div class="col-md-2">
        <div class="card" style="margin-bottom:8px;">
          <div class="card-head">
            <span class="card-head-title">Tools</span>
          </div>
          <ul class="list-group">
            <li class="list-group-item"><i class="fas fa-users-cog"></i><a class="drawer-link drawer-icon-link" id="pills-home-tab" data-toggle="pill" href="#pills-topics" role="tab" aria-controls="pills-home" aria-selected="true">Edit Users</a></li>
            <li class="list-group-item"><i class="fas fa-toolbox"></i><a id="pills-profile-tab" data-toggle="pill" href="#pills-comments" role="tab" aria-controls="pills-profile" aria-selected="false" class="drawer-link drawer-icon-link">Moderate
                Articles</a></li>
          </ul>
        </div>
      </div>

      <div class="col-md-9">
        <div class="tab-content" id="pills-tabContent">
          <div class="tab-pane fade show active" id="pills-topics" role="tabpanel" aria-labelledby="pills-home-tab">
            <div class="card" style="padding-left: 0; padding-right: 0;">
              <div class="card-head">
                <span class="card-head-title">All Users</span>
              </div>

              <table class="table table-dark">
                <thead>
                  <tr>
                    <th scope="col">Picture</th>
                    <th scope="col">Name</th>
                    <th scope="col">Username</th>
                    <th scope="col">Rank</th>
                    <th scope="col">Email</th>
                    <th scope="col">Change Rank</th>
                  </tr>
                </thead>
                <tbody>
                  <% users.forEach(function(usr){ %>
                  <tr>
                    <td class="td-img" style="background-image:url(<%= usr.picture %>);"></td>
                    <td><%= usr.firstname %> <%= usr.lastname %></td>
                    <td><%= usr.username %></td>
                    <td><%= usr.account %></td>
                    <td><%= usr.email %></td>
                    <td >
                      <form action="/admin/account/<%= usr._id %>" method="post" style="margin-right:8px;">
                        <div class="form-row">
                          <div class="col-8">
                            <select class="form-control form-inline" name="type" id="type" style="height:31px;">
                              <option value="user">user</option>
                              <option value="writer">writer</option>
                              <option value="admin">admin</option>
                              <option disabled>superuser</option>
                            </select>
                          </div>
                          <div class="col-4">
                            <button type="submit" class="btn btn-primary " class="btn btn-primary">Change</button>
                          </div>
                        </div>
                      </form>
                    </td>
                  </tr>
                  <% }); %>
                </tbody>
              </table>

            </div>
          </div>


          <div class="tab-pane fade" id="pills-comments" role="tabpanel" aria-labelledby="pills-profile-tab">
            <div class="card" style="padding-left: 0; padding-right: 0;">
              <div class="card-head">
                <span class="card-head-title">Current Articles</span>
              </div>

              <table class="table table-dark">
                <thead>
                  <tr>
                    <th scope="col">Cover</th>
                    <th scope="col">Title</th>
                    <th scope="col">Views</th>
                    <th scope="col">Standing</th>
                    <th scope="col">Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <% topics.forEach(function(topic){ %>
                  <tr>
                    <td class="td-img" style="background-image:url(<%= topic.picture %>);"></td>
                    <td><%= topic.title %></td>
                    <td><%= topic.views %></td>
                    <td class="text-<%= (topic.standing)<=0?'success':(topic.standing)>=2?'danger':'warning' %>"><%= (topic.standing)<=0?"Good":(topic.standing)>=2?"Poor":"Moderate" %></td>
                    <td>
                      <div class="dropdown">
                        <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                          Actions
                        </button>
                        <div class="dropdown-menu dropdown-menu-left" aria-labelledby="">
                          <a class="dropdown-item" href="/moderation/<%= topic._id %>/archive">Archive</a>
                          <a class="dropdown-item" href="/topic/edit/<%= topic._id %>">Edit</a>
                          <a class="dropdown-item" href="/moderation/more/<%= topic._id %>">More Info</a>
                        </div>
                      </div>
                    </td>
                  </tr>
                  <% }); %>
                </tbody>
              </table>

            </div>
          </div>




        </div>

      </div>
    </div>
  </div>
</body>

</html>
