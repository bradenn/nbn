<!DOCTYPE html>
<html lang="en" <% if(user != null){ %>data-theme="<%= user.theme %>" <% }else{ %> data-theme="dark" <% } %>>
<%- include("partials/header.ejs"); %>

<body>
  <%- include("partials/nav.ejs"); %>
  <div class="container" style="margin-top:32px;">
    <div class="row">
      <% topics.forEach(function(topic){ %>
      <div class="col-md-6">
        <a href="/topic/<%= topic._id %>" class="no-bs">
          <div clss="article-cont">
            <div class="article" style="background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75)), url(<%= topic.picture %>);">
              <div class="title">
                <%= topic.title %>
                <span class="topic-inline-subtext">by <strong><%= topic.owner.username %></strong>, updated <strong><%= timeSince(new Date(topic.date)) %> </strong>ago. &nbsp;<span class="badge badge-primary"><% var hh = topic.section; var ht = hh.charAt(0); var hy = ht.toUpperCase() + hh.substr(1); %> <%= hy %></span></span>
                <span class="topic-inline-subtext"><%= topic.views %> Views</span>
              </div>
            </div>
          </div>
        </a>
      </div>
      <% }); %>

</body>
<%- include("partials/footer.ejs"); %>

</html>
<%

function timeSince(date) {

  var seconds = Math.floor((new Date() - date) / 1000);

  var interval = Math.floor(seconds / 31536000);

  if (interval >= 1) {
    return interval + " years";
  }
  interval = Math.floor(seconds / 2592000);
  if (interval >= 1) {
    return interval + " months";
  }
  interval = Math.floor(seconds / 86400);
  if (interval >= 1) {
    return interval + " days";
  }
  interval = Math.floor(seconds / 3600);
  if (interval >= 1) {
    return interval + " hours";
  }
  interval = Math.floor(seconds / 60);
  if (interval >= 1) {
    return interval + " minutes";
  }
  return Math.floor(seconds) + " seconds";
}
var aDay = 24*60*60*1000
%>
