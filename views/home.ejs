<!DOCTYPE html>
<html lang="en" <% if(user != null){ %>data-theme="<%= user.theme %>" <% }else{ %> data-theme="dark" <% } %>>
<%- include("partials/header.ejs"); %>

<body>
  <%- include("partials/nav.ejs"); %>
  <div class="container" style="margin-top:32px;">
    <div class="row">
      <div class="col-md-3">
        <div class="card">
          <div class="card-head">
            <span class="card-head-title">Trending Articles</span>
          </div>
          <ul class="list-group">
            <% trending.forEach(function(topic){ %>
            <a href="/topic/<%= topic._id %>" class="no-bs">
              <li class="list-group-item">
                <div class="side-list-image" style="background-image:url(<%= topic.picture %>);"></div>
                <div class="drawer-container">
                  <h5><%= topic.title %></h5>
                  <span class="drawer-text"><%- topic.body %></span>
                </div>
              </li>
            </a>
            <% }); %>
          </ul>
        </div>
      </div>
      <div class="col-md-6">
        <div class="card">
          <% topics.forEach(function(topic){ %>
          <a href="/topic/<%= topic._id %>" class="no-bs">
            <div class="inline-article">
              <div class="image" style="background-image: url(<%= topic.picture %>);">

              </div>
              <div class="title">
                <h5><%= topic.title %><% if(topic.nsfw){ %>
                <span class="badge badge-danger">
                  NSFW
                </span>
                <% } %></h5>
                <span class="topic-inline-subtext">by <strong><%= topic.owner.username %></strong>,
                  updated <strong><%= timeSince(new Date(topic.date)) %> </strong>
                  ago. &nbsp;<span class="badge badge-primary">
                    <% var hh = topic.section; var ht = hh.charAt(0); var hy = ht.toUpperCase() + hh.substr(1); %>
                    <%= hy %></span> <%= topic.views %> Views

                </span>

              </div>

            </div>
          </a>
          <% }); %>
        </div>
      </div>


</body>
<%- include("partials/footer.ejs"); %>

</html>
<%

function timeSince(date) {

  var seconds = Math.floor((new Date() - date) / 1000);

  var interval = Math.floor(seconds / 31536000);

  if (interval >= 1) {
    return interval + " years";
  }
  interval = Math.floor(seconds / 2592000);
  if (interval >= 1) {
    return interval + " months";
  }
  interval = Math.floor(seconds / 86400);
  if (interval >= 1) {
    return interval + " days";
  }
  interval = Math.floor(seconds / 3600);
  if (interval >= 1) {
    return interval + " hours";
  }
  interval = Math.floor(seconds / 60);
  if (interval >= 1) {
    return interval + " minutes";
  }
  return Math.floor(seconds) + " seconds";
}
var aDay = 24*60*60*1000
%>
